<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一文弄懂 maven 仓库, 仓库优先级, settings pom配置关系及差异 | 一颗牙疼</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.9825735b.css" as="style"><link rel="preload" href="/assets/js/app.addd9418.js" as="script"><link rel="preload" href="/assets/js/2.fe0fd2e3.js" as="script"><link rel="preload" href="/assets/js/50.5ef3b2a0.js" as="script"><link rel="prefetch" href="/assets/js/10.1659eee1.js"><link rel="prefetch" href="/assets/js/11.9319467c.js"><link rel="prefetch" href="/assets/js/12.05fa7e85.js"><link rel="prefetch" href="/assets/js/13.4b2c2cdc.js"><link rel="prefetch" href="/assets/js/14.6aff91d2.js"><link rel="prefetch" href="/assets/js/15.73cba6c7.js"><link rel="prefetch" href="/assets/js/16.ad14d937.js"><link rel="prefetch" href="/assets/js/17.83571311.js"><link rel="prefetch" href="/assets/js/18.b0a6e7f9.js"><link rel="prefetch" href="/assets/js/19.fec1bc4e.js"><link rel="prefetch" href="/assets/js/20.060b0662.js"><link rel="prefetch" href="/assets/js/21.f72d8245.js"><link rel="prefetch" href="/assets/js/22.4ab2d9c4.js"><link rel="prefetch" href="/assets/js/23.cefb18a5.js"><link rel="prefetch" href="/assets/js/24.518305a1.js"><link rel="prefetch" href="/assets/js/25.09b45bb5.js"><link rel="prefetch" href="/assets/js/26.5ee059a8.js"><link rel="prefetch" href="/assets/js/27.ec46a179.js"><link rel="prefetch" href="/assets/js/28.89c4c633.js"><link rel="prefetch" href="/assets/js/29.b16f5906.js"><link rel="prefetch" href="/assets/js/3.d68f042b.js"><link rel="prefetch" href="/assets/js/30.4750eb47.js"><link rel="prefetch" href="/assets/js/31.5db7d6a3.js"><link rel="prefetch" href="/assets/js/32.c08f9630.js"><link rel="prefetch" href="/assets/js/33.de6d5486.js"><link rel="prefetch" href="/assets/js/34.5f323b81.js"><link rel="prefetch" href="/assets/js/35.ff1e4c26.js"><link rel="prefetch" href="/assets/js/36.5bb101eb.js"><link rel="prefetch" href="/assets/js/37.721f9e92.js"><link rel="prefetch" href="/assets/js/38.fd9ca724.js"><link rel="prefetch" href="/assets/js/39.78d0a655.js"><link rel="prefetch" href="/assets/js/4.0b2df6d7.js"><link rel="prefetch" href="/assets/js/40.5c885785.js"><link rel="prefetch" href="/assets/js/41.94e7113d.js"><link rel="prefetch" href="/assets/js/42.87230d18.js"><link rel="prefetch" href="/assets/js/43.f7a4b17c.js"><link rel="prefetch" href="/assets/js/44.72f30d8f.js"><link rel="prefetch" href="/assets/js/45.d8289568.js"><link rel="prefetch" href="/assets/js/46.bf8ea397.js"><link rel="prefetch" href="/assets/js/47.e53d1d78.js"><link rel="prefetch" href="/assets/js/48.dbdb2e5d.js"><link rel="prefetch" href="/assets/js/49.ce98ad74.js"><link rel="prefetch" href="/assets/js/5.ff2c75a4.js"><link rel="prefetch" href="/assets/js/51.f6d5c461.js"><link rel="prefetch" href="/assets/js/52.f6acb9db.js"><link rel="prefetch" href="/assets/js/53.180af64c.js"><link rel="prefetch" href="/assets/js/54.73b9a5f6.js"><link rel="prefetch" href="/assets/js/55.65a06df3.js"><link rel="prefetch" href="/assets/js/56.5c43f6ac.js"><link rel="prefetch" href="/assets/js/57.f8195cec.js"><link rel="prefetch" href="/assets/js/58.0001943c.js"><link rel="prefetch" href="/assets/js/59.8efdf6e8.js"><link rel="prefetch" href="/assets/js/6.a104c4e0.js"><link rel="prefetch" href="/assets/js/60.1903da9d.js"><link rel="prefetch" href="/assets/js/61.a7d0ec6c.js"><link rel="prefetch" href="/assets/js/62.339ce9d7.js"><link rel="prefetch" href="/assets/js/63.8b772a8a.js"><link rel="prefetch" href="/assets/js/64.3af363cb.js"><link rel="prefetch" href="/assets/js/65.6baef448.js"><link rel="prefetch" href="/assets/js/66.2336c125.js"><link rel="prefetch" href="/assets/js/67.5f51fded.js"><link rel="prefetch" href="/assets/js/68.bf06002d.js"><link rel="prefetch" href="/assets/js/69.4de9b4ea.js"><link rel="prefetch" href="/assets/js/7.661a7c8f.js"><link rel="prefetch" href="/assets/js/70.07597f48.js"><link rel="prefetch" href="/assets/js/71.8b1d6517.js"><link rel="prefetch" href="/assets/js/72.9fe08d47.js"><link rel="prefetch" href="/assets/js/73.cd6f3369.js"><link rel="prefetch" href="/assets/js/74.64a8b3ce.js"><link rel="prefetch" href="/assets/js/75.37c9d1ea.js"><link rel="prefetch" href="/assets/js/76.079ff603.js"><link rel="prefetch" href="/assets/js/77.b86dcc2b.js"><link rel="prefetch" href="/assets/js/8.cbcbaa9c.js"><link rel="prefetch" href="/assets/js/9.9cc097c6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9825735b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="一颗牙疼" class="logo"> <span class="site-name can-hide">一颗牙疼</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/01.Java/" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="https://github.com/Atoothache/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/01.Java/" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="https://github.com/Atoothache/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>服务器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>脚本语言</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>模板引擎</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全认证</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>杂文</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/100.杂文/VMware与主机互通并访问外网.html" class="sidebar-link">VMware虚拟机三种网络模式详解</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/100.杂文/一文弄懂 maven 仓库, 仓库优先级, settings pom配置关系及差异.html" class="active sidebar-link">一文弄懂 maven 仓库, 仓库优先级, settings pom配置关系及差异</a></li><li><a href="/100.杂文/使用GoogleKaptcha 生成验证码.html" class="sidebar-link">使用GoogleKaptcha 生成验证码</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/100.杂文/博客.html" class="sidebar-link">博客</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/100.杂文/博客.html#为什么你需要一个博客" class="sidebar-link">为什么你需要一个博客？</a></li><li class="sidebar-sub-header"><a href="/100.杂文/博客.html#什么是-vuepress-为什么要使用-vuepress" class="sidebar-link">什么是 VuePress，为什么要使用 VuePress ？</a></li><li class="sidebar-sub-header"><a href="/100.杂文/博客.html#为什么不是" class="sidebar-link">为什么不是...?</a></li></ul></li><li><a href="/100.杂文/正向代理yu反向代理.html" class="sidebar-link">nginx 正向代理yu反向代理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/100.杂文/正向代理yu反向代理.html#nginx-正向代理yu反向代理" class="sidebar-link">nginx 正向代理yu反向代理</a></li></ul></li><li><a href="/100.杂文/网站推荐.html" class="sidebar-link">网站推荐</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>搜索引擎</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>中间件</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="一文弄懂-maven-仓库-仓库优先级-settings-pom配置关系及差异"><a href="#一文弄懂-maven-仓库-仓库优先级-settings-pom配置关系及差异" class="header-anchor">#</a> 一文弄懂 maven 仓库, 仓库优先级, settings pom配置关系及差异</h1> <p>repository仓库
本地仓库
本机,一般.m2 本地仓库地址可以在settings.xml里边指定</p> <p>远程仓库
比如公司私有仓库 pom可以通过配置多个repository来,如果好多项目共用的话,可以在settings文件配置profile,这样新项目就不需要重复配置repository了</p> <p>中央仓库
maven必须至少知道一个远程仓库,中央仓库就是默认的仓库,不需要显示配置在maven的 super pom中配置的 兜底用的,找不到的jar会找他</p> <p>如果中央仓库慢可以用mirrors来替换它,它的id是central,在mirrorOf标签中配置它的标签就是替换了</p> <p>仓库在哪里配置
可以在settings OR pom xml中配置 可以嵌入到profile中,也可以单独通过repository配置然后profile通过id引用</p> <p>谁用仓库
profile(构建)标签会指定仓库</p> <p>server和repository如何关联
通过distributionManagement标签根据id关联起来</p> <p>依赖仓库的配置方式
中央仓库，这是默认的仓库
镜像仓库，通过 sttings.xml 中的 settings.mirrors.mirror 配置
全局profile仓库，通过 settings.xml 中的 settings.repositories.repository 配置
项目仓库，通过 pom.xml 中的 project.repositories.repository 配置
项目profile仓库，通过 pom.xml 中的 project.profiles.profile.repositories.repository 配置
本地仓库
依赖优先级关系由近(本地仓库)及远(中央仓库)</p> <p>强烈注意: 你的maven的环境变量会覆盖一切. 当你发现你修改settings不生效的时候,检查下你的maven home配置</p> <p>repo优先级
本地仓库jar&gt;global settings active profile&gt; user settings active profile&gt;pom profile&gt;pom repo&gt;user mirror&gt;global mirror</p> <p>pom中的repo配置高于user/global settings中的mirror
user/global settings中的activa profile高于pom中的repo
global settgings中的active profile高于user settings中的active profile
user settings active profile高于mirror(checked)</p> <p>但是settings定位不同,它倾向于提供一些公共的附属信息,而不是个性化的构建信息.它会尽量融合到你的pom中.
mirror镜像又是个什么东西
就是一个备份或冗余.并且你有的我也有并且我比你快 用镜像仓库替代默认的远程仓库</p> <p>用来替代在pom中repository定义的仓库(miorrorOf标签通过唯一的仓库id) maven的中央仓库id是central(在super pom中配置)</p> <p>注意:当远程仓库被镜像匹配到的，则在获取 jar 包将从镜像仓库获取，而不是我们配置的 repository 仓库, repository 将失去作用</p> <p>如果你不是以上两个目的就不用配置镜像了</p> <p>mirror优先级
见repo优先级 pom不支持配置</p> <p>profile是个什么东西
定义构建程序的资源和配置,如:
- 远程仓库列表
- 构建时本地路径及远程路径
- 唯一标志
- 自动触发逻辑
- 扩展属性列表
- 插件仓库列表
profile通过什么配置
通过profiles/profile标签配置
profile在哪里配置以及有什么区别
在settings和pom都可以配置
但是settings只能提供给pom: repository,plugin repository,以及free-form properties供pom使用
可以理解为setting的profile是对pom中的profile信息的补充以达到build的目的<br>
profile相关标签说明
Activation
自动触发/激活profile的条件逻辑 不是激活profile的唯一方式,还可以通过命令行-P yourWantedtoActiveProfile,anotherProfiletoActive</p> <p>可以配置自动激活条件特别多,具体参考文档 mvn help:active-profiles</p> <p>properties
对profile的扩展,配置一些属性值${x}</p> <p>注：如果该profile被激活，则可以在pom.xml中使用${user.install}。</p> <p>profile中Repositories
远程仓库列表，它是maven用来填充构建系统本地仓库所使用的一组远程仓库。</p> <p>远程仓库唯一标志/名称 release/snapshots配置 远程仓库url</p> <p>pluginRepositories
maven插件的仓库</p> <p>activeProfiles
手动激活profiles的列表,配置的是在pom中配置的profile的id 按照profile被应用的顺序定义activeProfile</p> <p>不管在哪里配置的profile都记得要激活 pom激活fangshi :</p> <activation><activeByDefault>true</activeByDefault></activation>
settings激活方式:
<activeProfiles><activeProfile>
      profile_user_settings
    </activeProfile></activeProfiles>
与pom中profile的区别与联系
settings.xml中的profile元素是pom.xml中profile元素的裁剪版本 它包含了id、activation、repositories、pluginRepositories和properties元素。 这里的profile元素只包含这五个子元素是因为这只关心构建系统这个整体
<p>如果一个settings.xml中的profile被激活，它的值会覆盖任何其它定义在pom.xml中带有相同id的profile。 settings的profile一般是个pom的profile提供补充信息, 一般是公共的,适合所有项目的</p> <p>settings文件是个什么东西
从settings.xml的文件名就可以看出，它是用来设置maven参数的配置文件。并且， settings.xml是maven的全局配置文件。而pom.xml文件是所在项目的局部配置。 Settings.xml中包含类似本地仓储位置、修改远程仓储服务器、认证信息等配置。</p> <p>settings.xml文件位置
settings.xml文件一般存在于两个位置： 全局配置: ${M2_HOME}/conf/settings.xml 用户配置: 𝑢𝑠𝑒𝑟.ℎ𝑜𝑚𝑒/.𝑚2/𝑠𝑒𝑡𝑡𝑖𝑛𝑔𝑠.𝑥𝑚𝑙𝑛𝑜𝑡𝑒：</p> <p>settings和pom之间的关系
settings偏向于全局配置 一般pom的优先高于settings,但是他们之间的信息是相互引用的</p> <p>Servers是个什么东西
如果需要用户名和密码就需要配置下server,不适合放在pom中,一般定义在settings中,由pom去引用</p> <p>仓库的下载和部署是在pom.xml文件中的repositories和distributionManagement元素中定义的。</p> <p>server如何跟repository关联
该 id 与 distributionManagement 中 repository 元素的 id 相匹配</p> <p>repository/profile 标签
profile可以再settings和pom中配置 repository无法单独在settings中配置,不报错不生效,但是可以配置到profile中</p> <p>repository和profile的关系
profile会用到repository repository也可以单独配置</p> <p>settings和pom优先级
要看具体标签来定 profile是settings的优先级最高 见repo优先级</p> <p>settings和pom之间的关联
一般是pom会取用setttings中的配置 settings一般全局和公共的配置</p> <p>Mirrors
用来替代某个仓库的,一般替代中央仓库,但是不局限于替代它.可以替代一切仓库 mirrorOf来指定仓库id,这个id是pom文件中 repository 的id</p> <p>mirrofOf标签
mirrofOf在哪配置
mirrorOf配置内容含义是什么
mirrorOf 标签里面放置的是 repository 配置的 id,为了满足一些复杂的需求，Maven还支持更高级的镜像配置</p> <p>mirrorOf配置规则
external:* = 不在本地仓库的文件才从该镜像获取
repo,repo1 = 远程仓库 repo 和 repo1 从该镜像获取
*,!repo1 =  所有远程仓库都从该镜像获取，除 repo1 远程仓库以外</p> <ul><li>= 所用远程仓库都从该镜像获取
maven的中央仓库id是central, 所以mirrorOf配置为central就达到了替换maven仓库的目的</li></ul> <p>repostitory,mirror,profile关系
repository就是jar包的库 mirror可以替换某个repository profile里面需要包含某个repository</p> <p>配置镜像仓库
在settings.xml 全局配置
<mirrors><mirror><id>aliyun</id> <name>aliyun</name> <mirrorOf>central</mirrorOf> <url>https://maven.aliyun.com/repository/central</url></mirror></mirrors>
仓库优先级(访问不通或者jar不存在自动切换)
见repo优先级</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/100.杂文/VMware与主机互通并访问外网.html" class="prev">
        VMware虚拟机三种网络模式详解
      </a></span> <span class="next"><a href="/100.杂文/使用GoogleKaptcha 生成验证码.html">
        使用GoogleKaptcha 生成验证码
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.addd9418.js" defer></script><script src="/assets/js/2.fe0fd2e3.js" defer></script><script src="/assets/js/50.5ef3b2a0.js" defer></script>
  </body>
</html>
